<script>
  const form = document.getElementById("f");
  const res  = document.getElementById("res");
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    res.textContent = "Génération en cours…";

    // ✅ envoyer en x-www-form-urlencoded
    const body = new URLSearchParams(new FormData(form));

    const r = await fetch("/api/gif", {
      method: "POST",
      body
    });

    if (!r.ok) { res.textContent = "Erreur génération GIF."; return; }
    const blob = await r.blob();
    const url = URL.createObjectURL(blob);
    res.innerHTML = `<a download="capture.gif" href="${url}">⬇️ Télécharger le GIF</a><br/><img style="max-width:100%;margin-top:10px" src="${url}" />`;
  });
</script>
